<!-- build time:Fri Feb 02 2018 22:07:35 GMT+0800 (CST) --><!DOCTYPE html><html class="theme-next mist" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3"><link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222"><meta name="keywords" content="Hexo, NexT"><meta name="description" content="什么是推荐系统？本章要教大家的是：如果构建一个系统，将具有相同品味、爱好的人聚集在一起，根据群体的偏好来为人们提供推荐。这种技术也叫做协作型过滤。其做法是：对一大群人进行搜索找出与我们品味相近的的一小群人对这小群人的偏爱的内容进行考察将这些内容组合起来构成一个经过排名的推荐列表这里的协作，个人理解就是你标注的喜好信息，"><meta property="og:type" content="article"><meta property="og:title" content="提供推荐"><meta property="og:url" content="laiqun.github.io/2017/11/05/Marking-Recommendations/index.html"><meta property="og:site_name" content="广阔天地，大有作为"><meta property="og:description" content="什么是推荐系统？本章要教大家的是：如果构建一个系统，将具有相同品味、爱好的人聚集在一起，根据群体的偏好来为人们提供推荐。这种技术也叫做协作型过滤。其做法是：对一大群人进行搜索找出与我们品味相近的的一小群人对这小群人的偏爱的内容进行考察将这些内容组合起来构成一个经过排名的推荐列表这里的协作，个人理解就是你标注的喜好信息，同时也会影响到别人。比如小张是个品味和你很相似的人，那么你向他推荐你喜欢的东西（"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="/2017/11/05/Marking-Recommendations/Euclidean_Distance.PNG"><meta property="og:image" content="/2017/11/05/Marking-Recommendations/pearson.png"><meta property="og:image" content="/2017/11/05/Marking-Recommendations/normlize.png"><meta property="og:image" content="/2017/11/05/Marking-Recommendations/pearson1.gif"><meta property="og:image" content="/2017/11/05/Marking-Recommendations/pearson2.gif"><meta property="og:image" content="/2017/11/05/Marking-Recommendations/pearson3.gif"><meta property="og:image" content="/2017/11/05/Marking-Recommendations/Euclidean_Distance.PNG"><meta property="og:image" content="/2017/11/05/Marking-Recommendations/transfer.png"><meta property="og:image" content="/2017/11/05/Marking-Recommendations/minus_relation.png"><meta property="og:updated_time" content="2017-11-26T03:30:44.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="提供推荐"><meta name="twitter:description" content="什么是推荐系统？本章要教大家的是：如果构建一个系统，将具有相同品味、爱好的人聚集在一起，根据群体的偏好来为人们提供推荐。这种技术也叫做协作型过滤。其做法是：对一大群人进行搜索找出与我们品味相近的的一小群人对这小群人的偏爱的内容进行考察将这些内容组合起来构成一个经过排名的推荐列表这里的协作，个人理解就是你标注的喜好信息，同时也会影响到别人。比如小张是个品味和你很相似的人，那么你向他推荐你喜欢的东西（"><meta name="twitter:image" content="/2017/11/05/Marking-Recommendations/Euclidean_Distance.PNG"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"5.1.3",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!0},fancybox:!0,tabs:!0,motion:{enable:!1,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="laiqun.github.io/2017/11/05/Marking-Recommendations/"><title>提供推荐 | 广阔天地，大有作为</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">广阔天地，大有作为</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">你看到我的筋斗云了嘛？</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="laiqun.github.io/2017/11/05/Marking-Recommendations/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="倔强的土豆"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="广阔天地，大有作为"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">提供推荐</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-05T09:42:02+08:00">2017-11-05 </time></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/2017/11/05/Marking-Recommendations/#comments" itemprop="discussionUrl"><span class="post-comments-count gitment-comments-count" data-xid="/2017/11/05/Marking-Recommendations/" itemprop="commentsCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="什么是推荐系统？"><a href="#什么是推荐系统？" class="headerlink" title="什么是推荐系统？"></a>什么是推荐系统？</h1><p>本章要教大家的是：如果构建一个系统，将具有相同品味、爱好的人聚集在一起，根据群体的偏好来为人们提供推荐。</p><p>这种技术也叫做协作型过滤。其做法是：</p><ol><li>对一大群人进行搜索</li><li>找出与我们品味相近的的一小群人</li><li>对这小群人的偏爱的内容进行考察</li><li>将这些内容组合起来构成一个经过排名的推荐列表<blockquote><p>这里的协作，个人理解就是你标注的喜好信息，同时也会影响到别人。比如小张是个品味和你很相似的人，那么你向他推荐你喜欢的东西（即这个东西被你标注为喜欢），他也很可能喜好。推荐系统会利用这个喜好信息，决定要不要向小张推荐这个东西。</p></blockquote></li></ol><h1 id="收集数据"><a href="#收集数据" class="headerlink" title="收集数据"></a>收集数据</h1><p>我们收集一份不同人，对多部电影的评分数据，电影的评分为1-5分，依照对电影的评分来表达评论者对这部电影的喜好程度。</p><table><thead><tr><th>评论者\电影名</th><th>王牌特工</th><th>煎饼侠</th><th>疯狂原始人</th><th>超能陆战队</th><th>天空之城</th><th>喜剧之王</th></tr></thead><tbody><tr><td>小王</td><td>2.5</td><td>3.5</td><td>3.0</td><td>3.5</td><td>2.5</td><td>3.0</td></tr><tr><td>小张</td><td>3.0</td><td>3.5</td><td>1.5</td><td>5.0</td><td>3.5</td><td>3.0</td></tr><tr><td>小李</td><td>2.5</td><td>3.0</td><td>没看过</td><td>3.5</td><td>没看过</td><td>4.0</td></tr><tr><td>小强</td><td>没看过</td><td>3.5</td><td>3.0</td><td>4.0</td><td>2.5</td><td>4.5</td></tr><tr><td>小明</td><td>3.0</td><td>4.0</td><td>2.0</td><td>3.0</td><td>2.0</td><td>3.0</td></tr><tr><td>小红</td><td>3.0</td><td>4.0</td><td>没看过</td><td>5.0</td><td>3.5</td><td>3.0</td></tr><tr><td>小刘</td><td>没看过</td><td>4.5</td><td>没看过</td><td>4.0</td><td>1.0</td><td>没看过</td></tr></tbody></table><blockquote><p>为了能够计算相似度，不管偏好是怎样表达的，我们需要一种方法将它们对应要数字上，因为数字比较容易计算距离和相似性。</p><p>比如说：是否买过，已购买对应1，为购买对应为0；在线购物时，买过标记为1，浏览过标记为0，没买标记为-1；投票时，喜好标记为1，不喜欢标记为-1，未投票标记为0</p></blockquote><p>我们使用python的数据结构来描述上述表格：<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">critics=&#123;</span><br><span class="line"><span class="string">'小王'</span>: &#123;<span class="string">'王牌特工'</span>: <span class="number">2.5</span>, <span class="string">'煎饼侠'</span>: <span class="number">3.5</span>,<span class="string">'疯狂原始人'</span>: <span class="number">3.0</span>, <span class="string">'超能陆战队'</span>: <span class="number">3.5</span>, <span class="string">'天空之城'</span>: <span class="number">2.5</span>, <span class="string">'喜剧之王'</span>: <span class="number">3.0</span>&#125;,</span><br><span class="line"><span class="string">'小张'</span>: &#123;<span class="string">'王牌特工'</span>: <span class="number">3.0</span>, <span class="string">'煎饼侠'</span>: <span class="number">3.5</span>, <span class="string">'疯狂原始人'</span>: <span class="number">1.5</span>, <span class="string">'超能陆战队'</span>: <span class="number">5.0</span>, <span class="string">'喜剧之王'</span>: <span class="number">3.0</span>, <span class="string">'天空之城'</span>: <span class="number">3.5</span>&#125;, </span><br><span class="line"><span class="string">'小李'</span>: &#123;<span class="string">'王牌特工'</span>: <span class="number">2.5</span>, <span class="string">'煎饼侠'</span>: <span class="number">3.0</span>,<span class="string">'超能陆战队'</span>: <span class="number">3.5</span>, <span class="string">'喜剧之王'</span>: <span class="number">4.0</span>&#125;,</span><br><span class="line"><span class="string">'小强'</span>: &#123;<span class="string">'煎饼侠'</span>: <span class="number">3.5</span>, <span class="string">'疯狂原始人'</span>: <span class="number">3.0</span>,<span class="string">'喜剧之王'</span>: <span class="number">4.5</span>, <span class="string">'超能陆战队'</span>: <span class="number">4.0</span>, <span class="string">'天空之城'</span>: <span class="number">2.5</span>&#125;,</span><br><span class="line"><span class="string">'小明'</span>: &#123;<span class="string">'王牌特工'</span>: <span class="number">3.0</span>, <span class="string">'煎饼侠'</span>: <span class="number">4.0</span>, <span class="string">'疯狂原始人'</span>: <span class="number">2.0</span>, <span class="string">'超能陆战队'</span>: <span class="number">3.0</span>, <span class="string">'喜剧之王'</span>: <span class="number">3.0</span>,<span class="string">'天空之城'</span>: <span class="number">2.0</span>&#125;, </span><br><span class="line"><span class="string">'小红'</span>: &#123;<span class="string">'王牌特工'</span>: <span class="number">3.0</span>, <span class="string">'煎饼侠'</span>: <span class="number">4.0</span>,<span class="string">'喜剧之王'</span>: <span class="number">3.0</span>, <span class="string">'超能陆战队'</span>: <span class="number">5.0</span>, <span class="string">'天空之城'</span>: <span class="number">3.5</span>&#125;,</span><br><span class="line"><span class="string">'小刘'</span>: &#123;<span class="string">'煎饼侠'</span>:<span class="number">4.5</span>,<span class="string">'天空之城'</span>:<span class="number">1.0</span>,<span class="string">'超能陆战队'</span>:<span class="number">4.0</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h1 id="计算相似度的方法"><a href="#计算相似度的方法" class="headerlink" title="计算相似度的方法"></a>计算相似度的方法</h1><p>搜集完数据后，我们需要一种算法来确定人们在品味方面的相似程度。<br>算法将每个人与所有其他人进行对比，并计算它们的相似度评价值。<br>本节将介绍两种计算相似度评价值的方法：<strong>欧几里德距离</strong>和<strong>皮尔逊相关度</strong>。</p><h2 id="欧几里德距离"><a href="#欧几里德距离" class="headerlink" title="欧几里德距离"></a>欧几里德距离</h2><p>这里展示了一副以不同人对《煎饼侠》和《天空之城》的评价绘制成的坐标图；</p><img src="/2017/11/05/Marking-Recommendations/Euclidean_Distance.PNG" title="Educlidean_Distance"><p>上图中蓝点为不同的人对两部电影的评分构成的坐标点。从图中可以看出，两个人的坐标点越近，它们的兴趣偏好就越相似，因此我们需要计算两个坐标点之间的距离。</p><p>为了计算“小刘”和“小明”的距离，我们可以<strong>计算出每一个轴上的差值</strong>，求<strong>平方后再相加</strong>，最后对总和求<strong>平方根</strong>。</p><p>对于二维坐标图，你会发现这就是两点之间的直线距离公式。</p><p>$$distance=\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}$$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line">sqrt(pow(<span class="number">4.5</span><span class="number">-4</span>,<span class="number">2</span>)+pow(<span class="number">1</span><span class="number">-2</span>,<span class="number">2</span>))</span><br></pre></td></tr></table></figure><p>偏好越相似的人，距离就越短。但是我们需要的时越相似，评分就越高的计算方法，怎么办？ 先取一个倒数，就变成距离越短，数值越大了。<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>/(sqrt(pow(<span class="number">4.5</span><span class="number">-4</span>,<span class="number">2</span>)+pow(<span class="number">1</span><span class="number">-2</span>,<span class="number">2</span>)))</span><br></pre></td></tr></table></figure><p></p><p>这里会有一个问题:两个人距离为0时，上述公式变成1/0，会发生除数为0的错误。</p><p>为了避免这个错误，我们再分母上加1，距离为0时，公式变成 1/(1+0)=1。这个公式的取值为(0,1]之间的值，返回值越接近1表明两个品味越相似。<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>/(<span class="number">1</span>+ sqrt(pow(<span class="number">4.5</span><span class="number">-4</span>,<span class="number">2</span>)+pow(<span class="number">1</span><span class="number">-2</span>,<span class="number">2</span>)))</span><br></pre></td></tr></table></figure><p></p><p>现在我们可以利用这个公式，计算一个人与另一个人的相似度啦。<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt,pow</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sim_distance</span><span class="params">(critics,name1,name2)</span>:</span></span><br><span class="line">    si=set()</span><br><span class="line">    <span class="comment"># 找出它们两个人都看过的电影，放到集合si中</span></span><br><span class="line">    <span class="keyword">for</span> movie <span class="keyword">in</span> critics[name1]:</span><br><span class="line">        <span class="keyword">if</span> movie <span class="keyword">in</span> critics[name2]:</span><br><span class="line">            si.add(movie)</span><br><span class="line">    <span class="keyword">if</span> len(si)==<span class="number">0</span>:<span class="comment"># 没有共同之处，返回0</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="comment"># 对于每一个他们都看过的电影，计算平方和</span></span><br><span class="line">    <span class="comment"># 这里使用了python的列表推导式语法</span></span><br><span class="line">    sum_of_squares = sum([pow(critics[name1][movie]-critics[name2][movie],<span class="number">2</span>) <span class="keyword">for</span> movie <span class="keyword">in</span> si ])</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>/(<span class="number">1</span>+sqrt(sum_of_squares))</span><br></pre></td></tr></table></figure><p></p><p>现在，我们可以调用这个函数，两计算‘小王’和‘小张’的相似度啦！<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sim_distance(critics,<span class="string">'小王'</span>,<span class="string">'小张'</span>):</span><br><span class="line"><span class="comment"># 返回0.294...</span></span><br></pre></td></tr></table></figure><p></p><h2 id="皮尔逊相关度"><a href="#皮尔逊相关度" class="headerlink" title="皮尔逊相关度"></a>皮尔逊相关度</h2><p>这里先看个例子：</p><p>假定有两组数据，第一组为[1,3,5]，第二组为[3,5,7]。</p><p>第一组为小李，对第一部电影的评价，对第二部电影的评价，对第三部电影的评价。</p><p>第二组为小王，对第一部电影的评价，对第二部电影的评价，对第三部电影的评价。</p><p>用直线去拟合这两组数据，得到的分别是$ y_1=2x-1 $，和$ y_2=2x+1 $，x取值为1到3。</p><p>你会发现$y_1$和$y_2$有很强的正相关性，即$y_1$分值增大的时候，$y_2$也是增大的，反过来也是如此。</p><p>$y_2$和$y_1$的关系可以表示为$y_2=y_1+2$，虽然它们再不同的电影上给出的分值并不一样，但是它们有很强的正相关性，只是偏移量不同，即小李对每部电影的评价都加2分，就是小王对每部电影的评价。</p><p>小王似乎总是喜欢“夸大分值”，总是倾向于给出比小李更高的分值，而且分值之差又始终保持一致，他们依然可能存在很好的相关性。此时用欧几里德距离的评价方法，因为一个人始终比另一个人打的分值高，得出两个人不近似的结论。</p><p>此时用皮尔逊相似度可以表示出他们之间的相关性。</p><h3 id="从几何中的cos夹角公式理解皮尔逊相似度"><a href="#从几何中的cos夹角公式理解皮尔逊相似度" class="headerlink" title="从几何中的cos夹角公式理解皮尔逊相似度"></a>从几何中的cos夹角公式理解皮尔逊相似度</h3><p>我们将上面的坐标公式改为向量模式：<br><img src="/2017/11/05/Marking-Recommendations/pearson.png" title="pearson"><br>和前面的欧几里德距离的图一样，坐标点没变，不过此时我们使用向量来描述坐标点，向量是一种投影的概念，对于小刘来说，在x轴上的投影为1，y轴投影为4.5；对于小张来说，其在x轴上的投影为3.5，y轴上的投影也为3.5。</p><p>这里的x轴指对《天空之城》评分，y轴是《煎饼侠》的评分。以原点为起始投影点，我们画上指向小刘和小张的向量，两个向量的夹角的余弦值就是他俩的相似度。</p><p>我们知道平面上两个向量的夹角可以用公式：</p><p>$$ \cos( \theta ) = {a \bullet b \over |a| \times |b|} $$</p><p>两个向量$a=[a_1,a_2,…,a_n]$和$b=[b_1,b_2,…,b_n]$的点积定义为：</p><p>$$ a\bullet b = a_1b_1+a_2b_2+….a_nb_n $$<br>二维向量的模定义为：<br>$$ \sqrt{x^2+y^2} $$<br>三维的向量模定义为：<br>$$ \sqrt{x^2+y^2+z^2} $$<br>同理可以推广到N维。</p><p>举例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 举例a向量为(1,3) b向量为(3,5) </span></span><br><span class="line"><span class="comment"># b向量中每一项为a向量中每一项加2，公式表示为 b=a+2</span></span><br><span class="line">vec1 =  [<span class="number">1</span>,<span class="number">3</span>]</span><br><span class="line">vec2 =  [<span class="number">3</span>,<span class="number">5</span>]</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cos</span><span class="params">(vec1,vec2)</span>:</span></span><br><span class="line">    numerator= (vec1[<span class="number">0</span>]*vec2[<span class="number">0</span>]+vec1[<span class="number">1</span>]*vec2[<span class="number">1</span>])</span><br><span class="line">    denominator= sqrt((vec1[<span class="number">0</span>]**<span class="number">2</span>+vec1[<span class="number">1</span>]**<span class="number">2</span>)*(vec2[<span class="number">0</span>]**<span class="number">2</span>+vec2[<span class="number">1</span>]**<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> numerator/denominator</span><br><span class="line">cos(vec1,vec2)</span><br><span class="line"><span class="comment">#(1*3+3*5)/sqrt((1+9)*(9+25))</span></span><br><span class="line"><span class="comment">#结果为0.9761870601839528</span></span><br><span class="line"><span class="comment">#如果我们对向量进行标准化，即向量中的每个元素都减去这个向量的平均值。</span></span><br><span class="line">avg_vec1 = sum(vec1)/len(vec1)  <span class="comment">#(1+3)/2=2</span></span><br><span class="line">avg_vec2 = sum(vec2)/len(vec2)  <span class="comment">#(3+5)/2=4</span></span><br><span class="line">vec1_norm = [item- avg_vec1 <span class="keyword">for</span> item <span class="keyword">in</span> vec1] <span class="comment">#vec1变为[-1,1]</span></span><br><span class="line"><span class="comment"># 计算过程为[1-2,3-2]</span></span><br><span class="line">vec2_norm = [item- avg_vec2 <span class="keyword">for</span> item <span class="keyword">in</span> vec2] <span class="comment">#vec2变为[-1,1]</span></span><br><span class="line"><span class="comment"># 计算过程为[3-4,5-4]</span></span><br><span class="line">cos(vec1_norm,vec2_norm)</span><br><span class="line"><span class="comment">#结果为1</span></span><br></pre></td></tr></table></figure><p>我们将向量进行标准化，即每个向量中的元素都减去这个向量的平均值。</p><p>至于为什么向量中每个元素于要减去向量的平均值?</p><p>拿上面小李和小王的例子来说，小王心中一般般的标准为3分，越是小于3分，表明越不喜欢;越是大于3分，表示越喜欢。而小李心中一般般的标准为5分，越是小于5分，表明越不喜欢，越是大于5分，表示越喜欢；这时候都减去平均值，就知道他们的喜欢（为正数）还是不喜欢（为负数）了。</p><p>向量标准化的效果示意图：<br><img src="/2017/11/05/Marking-Recommendations/normlize.png" title="normlize"></p><blockquote><p>假设由两个人，他们给两个电影的评分分别是(1,4)和(4,1)，评分趋势完全相反。未标准化时，他们之间的夹角小于90度，标准化后，变成(-1.5,1.5)和(1.5,-1.5),是180度的，表明他们给出的评分趋势正好相反（cos(180)=-1）。<br>再做一个假设，两个人，他们给两个电影的评分分别是(1,4)和(5,2)。未标准化时，他们之间的夹角小于90度，标准化后，变成(-1.5,1.5)和(1.5,-1.5),是180度的，表明他们给出的评分趋势正好相反。</p></blockquote><p>后面除上各自向量的模，是为了解决向量的长度不一致的问题。因为两个向量的夹角与两个向量的长度没有任何关系。</p><h3 id="从概率论的相关系数来理解皮尔逊相似度"><a href="#从概率论的相关系数来理解皮尔逊相似度" class="headerlink" title="从概率论的相关系数来理解皮尔逊相似度"></a>从概率论的相关系数来理解皮尔逊相似度</h3><p>皮尔逊相似度也可以写成：<br>$$ \Upsilon(X,Y)={Cov(X,Y) \over \sqrt{Var|X|Var|Y|} } $$</p><p>其中$Cov(X,Y)$表示X和Y的协方差,$\sqrt{Var|X|}$表示X的标准差，$\sqrt{Var|X|}$表示Y的标准差。<br>依靠上面的公式可以判断两组数的线性关系程度。</p><p>那么协方差是什么？<br>$$ Cov(X,Y)={\sum_1^n(x-\overline x)(y-\overline y) \over n} $$<br>协方差就是两个人的跳舞的舞步协同程度，以均值作为向前、向后的参照点，两个人一起向前走或者向后退，协方差就是正值，如果一个向前一个向后，协方差就是负值，如果有一个人没动，就是零。</p><p>表现为向量中每个元素减去均值乘上另外一个向量的对应元素减去均值，最后要除上他们总的活动步数（向量中元素的个数，公式中的n）。这就是协方差。</p><p>考虑到每个人的舞步尺度不一样，需要除上他们的标准差。这就是相关系数啦！</p><p>后面除上他们的标准差，是为了解决评分区间尺度不一致的问题。因为标准差(方差)就是度量一组数值和平均值之间的差距的。小王评分浮动为[0,6]之间，平均分为3；而小李的评分浮动区间为[0,10],平均分为5。小王的评分区间分数乘上(5/3)就是对应到小李的评分区间的评分。小李那边的分值，可以看作是小王的分值夸大(5/3)的结果。各自除上各自的标准差（代表评分的浮动范围，为0，表示数据不浮动，区间内只有一个数可用）之后，就可以认为他们的评分区间的大小一致啦。和向量余弦公式中的除上向量的模有异曲同工之妙！</p><p>标准差公式：<br>$$ \sqrt{Var|X|}=\sqrt{\sum_1^n(x-\overline x) \over n} $$</p><p>举例：<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">vec1 =  [<span class="number">1</span>,<span class="number">3</span>]</span><br><span class="line">vec2 =  [<span class="number">3</span>,<span class="number">5</span>]</span><br><span class="line">avg_vec1 = sum(vec1)/len(vec1)  <span class="comment">#(1+3)/2=2</span></span><br><span class="line">avg_vec2 = sum(vec2)/len(vec2)  <span class="comment">#(3+5)/2=4</span></span><br><span class="line">vec1_norm = [item- avg_vec1 <span class="keyword">for</span> item <span class="keyword">in</span> vec1] <span class="comment">#vec1变为[-1,1]</span></span><br><span class="line"><span class="comment"># 计算过程为[1-2,3-2]</span></span><br><span class="line">vec2_norm = [item- avg_vec2 <span class="keyword">for</span> item <span class="keyword">in</span> vec2] <span class="comment">#vec2变为[-1,1]</span></span><br><span class="line"><span class="comment"># 计算过程为[3-4,5-4]</span></span><br><span class="line">numerator= (vec1[<span class="number">0</span>]*vec2[<span class="number">0</span>]+vec1[<span class="number">1</span>]*vec2[<span class="number">1</span>])/len(vec1)</span><br><span class="line">denominator= sqrt((vec1[<span class="number">0</span>]**<span class="number">2</span>+vec1[<span class="number">1</span>]**<span class="number">2</span>)/len(vec1))*sqrt((vec2[<span class="number">0</span>]**<span class="number">2</span>+vec2[<span class="number">1</span>]**<span class="number">2</span>)/len(vec1)))</span><br><span class="line"><span class="keyword">return</span> numerator/denominator</span><br></pre></td></tr></table></figure><p></p><p>跟上面的向量标准化后余弦夹角公式很像有没有?!只不过分子、分母都除上了单个向量的元素个数。</p><p>书上的例子，公式怎么和这里不一样？</p><p>皮尔逊相似度计算公式有4种，这只是其中之一。</p><p>另外三种公式是：</p><img src="/2017/11/05/Marking-Recommendations/pearson1.gif" title="pearson1"> <img src="/2017/11/05/Marking-Recommendations/pearson2.gif" title="pearson2"> <img src="/2017/11/05/Marking-Recommendations/pearson3.gif" title="pearson3"><p>四种公式完全等价。公式的值域区间为-1到1,为1表示他们喜好完全一样，为-1表示喜好完全相反。</p><p>我们利用公式3，来编写计算皮尔逊相似度的函数:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Returns the Pearson correlation coefficient for p1 and p2</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sim_pearson</span><span class="params">(prefs,p1,p2)</span>:</span></span><br><span class="line">  <span class="comment"># Get the list of mutually rated items</span></span><br><span class="line">  si=set()</span><br><span class="line">  <span class="keyword">for</span> item <span class="keyword">in</span> prefs[p1]: </span><br><span class="line">    <span class="keyword">if</span> item <span class="keyword">in</span> prefs[p2]: si.add(item)</span><br><span class="line">  <span class="comment"># if they are no ratings in common, return 0</span></span><br><span class="line">  <span class="keyword">if</span> len(si)==<span class="number">0</span>: <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">  <span class="comment"># Sum calculations</span></span><br><span class="line">  n=len(si)</span><br><span class="line">  <span class="comment"># Sums of all the preferences</span></span><br><span class="line">  sum1=sum([prefs[p1][it] <span class="keyword">for</span> it <span class="keyword">in</span> si])</span><br><span class="line">  sum2=sum([prefs[p2][it] <span class="keyword">for</span> it <span class="keyword">in</span> si])</span><br><span class="line">  <span class="comment"># Sums of the squares</span></span><br><span class="line">  sum1Sq=sum([pow(prefs[p1][it],<span class="number">2</span>) <span class="keyword">for</span> it <span class="keyword">in</span> si])</span><br><span class="line">  sum2Sq=sum([pow(prefs[p2][it],<span class="number">2</span>) <span class="keyword">for</span> it <span class="keyword">in</span> si])	</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Sum of the products(乘积)</span></span><br><span class="line">  pSum=sum([prefs[p1][it]*prefs[p2][it] <span class="keyword">for</span> it <span class="keyword">in</span> si])</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Calculate r (Pearson score)</span></span><br><span class="line">  num=pSum-(sum1*sum2/n)</span><br><span class="line">  den=sqrt((sum1Sq-pow(sum1,<span class="number">2</span>)/n)*(sum2Sq-pow(sum2,<span class="number">2</span>)/n))</span><br><span class="line">  <span class="keyword">if</span> den==<span class="number">0</span>: <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">  r=num/den</span><br><span class="line">  <span class="keyword">return</span> r</span><br></pre></td></tr></table></figure><p>测试这个函数:<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sim_pearson(critics,<span class="string">'小王'</span>,<span class="string">'小张'</span>)</span><br><span class="line"><span class="comment">#结果为 0.3960</span></span><br></pre></td></tr></table></figure><p></p><h2 id="应该选用哪种相似性度量方法"><a href="#应该选用哪种相似性度量方法" class="headerlink" title="应该选用哪种相似性度量方法"></a>应该选用哪种相似性度量方法</h2><p>使用哪种方法最优，完全取决于具体应用，你想看看哪种方法能获得更好的效果，皮尔逊、欧几里得，或者其他方法，都是值得一试的。</p><p>还有很多其他的相似性函数：<strong>Jaccard系数</strong>或<strong>曼哈顿距离算法</strong>。</p><p>作为通用的相似度计算函数，你要把他们编写为返回值越大代表相似度越大的形式。</p><h1 id="寻找与自己相似品味的群体"><a href="#寻找与自己相似品味的群体" class="headerlink" title="寻找与自己相似品味的群体"></a>寻找与自己相似品味的群体</h1><p>既然我们已经有了可以对两个人进行相似度比较的函数，那么我们就可以指定一个人，让他和一组人进行相似度比对，找到与你最相似的一部分人。<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">topMatches</span><span class="params">(critics,person,n=<span class="number">5</span>,similarity=sim_pearson)</span>:</span></span><br><span class="line">    scores =[(similarity(critics,person,other),other)</span><br><span class="line">            <span class="keyword">for</span> other <span class="keyword">in</span> critics <span class="keyword">if</span> other!=person]<span class="comment"># 自己不能跟自己比</span></span><br><span class="line">    scores.sort()<span class="comment">#按分值从小到打排序</span></span><br><span class="line">    scores.reverse()<span class="comment">#逆序 分值高的再前面</span></span><br><span class="line">    <span class="keyword">return</span> scores[<span class="number">0</span>:n]<span class="comment"># 只返回前n个最相似的人</span></span><br></pre></td></tr></table></figure><p></p><p>测试<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">topMatches(critics,<span class="string">'小刘'</span>,n=<span class="number">3</span>)</span><br><span class="line"><span class="comment">#[(0.99,'小王'),(0.92,'小明'),(0.89,'小强')]</span></span><br></pre></td></tr></table></figure><p></p><h1 id="推荐物品"><a href="#推荐物品" class="headerlink" title="推荐物品"></a>推荐物品</h1><p>我们可以查找一个品味与我最相似的人，从他喜欢的电影列表中找一个自己没看过的，但这样根本没用用到集体的智慧。仅仅考虑了一个与我们最相似的个体而已。<br>有可能的情况是：这个品味与我最相似的人，刚好没看过一个我可能很喜欢的电影，但是跟我相似度排第二的人看过。这时，因为仅考虑了最相似的那一个，会导致我错过这场精彩的电影。</p><p>还有可能与我最相似的那个人，大部分情况下和我相似，他看过的大部分电影我都喜欢，但是可能他受过什么刺激，比如特别不喜欢某一部鬼神片；而我凑巧喜欢，跟我相似度排第二、第三也喜欢这部电影。这时候，仅仅因为跟我最相似的人有一点点癖好和我凑巧相反（成语：大同小异），因为他的“一面之辞”而会导致我错过这场精彩的电影。</p><p>这不符合集体智慧的想法。</p><blockquote><p>“从一大群人中搜集的答案可以使我们得出关于群组的统计结论，组中的个体将被忽视，将成百上千人的想法组合在一起，形成一种不依赖个人观点的结论。”</p></blockquote><p>怎么办？！那就投票呗！大家都打个分，来个平均，就代表集体的评分啦！</p><p>每个评委对一部电影的评分为1-5分，最后除上总的评委人数，就得到平均分。</p><p>为什么是平均分呐？</p><p>可能某一部老电影，看的人特别多，评论也多；而另外一部精彩电影是刚发布的，还没几个人看，我们不想忽略这部精彩的新电影的话，就要把不同人的评分加起来，除上总的评论人数。</p><p>但是存在个问题，我比较中意和我相似的人给出的评分，而跟我不相似的人，我就越想忽略他的评分。</p><p>怎么办？</p><p>我们给每人一个权重呗！ 与我最相似的，权重为1，其投票分数要乘上权重1；与我相似度为0.5的，其投票分数要乘上权重0.5；与我相似度为0的，其投票分数要乘上权重0。最后，我们除上总的评委人数。等等，这里的总投票人数怎么算？现在评委的分数有了权重，那么总的评委人数的计算方式也需要改改。我们规定，与我们相似度为1的算一个完整的人；相似度为0.5的，算是半个人，相似度为0的，就不能把它当人看。依此来计算总的评委人数。</p><p>就这么办！</p><p>这里以‘小刘’为例，开始讲解：<br>根据上一小节的结论，‘小刘’与其他人的相似度为：</p><p>#[(0.99,’小王’),(0.92,’小明’),(0.89,’小强’),(0.66,’小红’),(0.38,’小张’)]<br>看下上方表格的6部电影小刘那几部没看过？<br>分别是《喜剧之王》、《王牌特工》、《疯狂原始人》</p><table><thead><tr><th>评论者</th><th>相似度</th><th>给《喜剧之王》的评分</th><th>评分*权重(相似度)</th></tr></thead><tbody><tr><td>小王</td><td>0.99</td><td>3.0</td><td>3.0*0.99=2.97</td></tr><tr><td>小明</td><td>0.92</td><td>3.0</td><td>3.0*0.92=2.77</td></tr><tr><td>小强</td><td>0.89</td><td>4.5</td><td>4.5*0.89=4.02</td></tr><tr><td>小红</td><td>0.66</td><td>3.0</td><td>3.0*0.66=1.99</td></tr><tr><td>小张</td><td>0.38</td><td>3.0</td><td>3.0*0.38=1.14</td></tr><tr><td><strong>总和</strong></td><td>3.84(相似度之和，相当于总投票人数)</td><td>不计</td><td>12.89(带权重的评分的累加和)</td></tr></tbody></table><p>故：《喜剧之王》这部电影的带权重的平均分12.89/3.84=3.35。</p><p>同样的方法，我们分别计算下《王牌特工》和《疯狂原始人》的带权重的平均分：</p><table><thead><tr><th>评论者</th><th>相似度</th><th>给《王牌特工》的评分</th><th>评分*权重(相似度)</th></tr></thead><tbody><tr><td>小王</td><td>0.99</td><td>2.5</td><td>2.5*0.99=2.48</td></tr><tr><td>小明</td><td>0.92</td><td>3.0</td><td>3.0*0.92=2.77</td></tr><tr><td>小强</td><td>小强没看过这部电影，故视为弃权票，不计人数</td><td>没看过这部电影</td><td>因为没看过，视为0，不计</td></tr><tr><td>小红</td><td>0.66</td><td>3.0</td><td>3.0*0.66=1.99</td></tr><tr><td>小张</td><td>0.38</td><td>3.0</td><td>3.0*0.38=1.14</td></tr><tr><td><strong>总和</strong></td><td>2.95(相似度之和，相当于总投票人数)</td><td>不计</td><td>8.38(带权重的评分的累加和)</td></tr></tbody></table><p>故：《王牌特工》这部电影的带权重的平均分8.38/2.95=2.83。</p><table><thead><tr><th>评论者</th><th>相似度</th><th>给《疯狂原始人》的评分</th><th>评分*权重(相似度)</th></tr></thead><tbody><tr><td>小王</td><td>0.99</td><td>3.0</td><td>3.0*0.99=2.97</td></tr><tr><td>小明</td><td>0.92</td><td>2.0</td><td>2.0*0.92=1.85</td></tr><tr><td>小强</td><td>0.89</td><td>3.0</td><td>3.0*0.89=2.68</td></tr><tr><td>小红</td><td>小红没看过这部电影，故视为弃权票，不计人数</td><td>没看过这部电影</td><td>因为没看过，视为0，不计</td></tr><tr><td>小张</td><td>0.38</td><td>1.5</td><td>1.5*0.38=0.57</td></tr><tr><td><strong>总和</strong></td><td>3.18(相似度之和，相当于总投票人数)</td><td>不计</td><td>8.07(带权重的评分的累加和)</td></tr></tbody></table><p>故：《疯狂原始人》这部电影的带权重的平均分8.07/3.18=2.53。</p><p>写代码描述上述的过程<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Gets recommendations for a person by using a weighted average</span></span><br><span class="line"><span class="comment"># of every other user's rankings</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getRecommendations</span><span class="params">(critics,person,similarity=sim_pearson)</span>:</span></span><br><span class="line">  totals=&#123;&#125;</span><br><span class="line">  simSums=&#123;&#125;</span><br><span class="line">  <span class="keyword">for</span> other <span class="keyword">in</span> critics:</span><br><span class="line">    <span class="comment"># don't compare me to myself</span></span><br><span class="line">    <span class="keyword">if</span> other==person: <span class="keyword">continue</span></span><br><span class="line">    sim=similarity(critics,person,other)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ignore scores of zero or lower</span></span><br><span class="line">    <span class="keyword">if</span> sim&lt;=<span class="number">0</span>: <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> critics[other]:</span><br><span class="line">	    </span><br><span class="line">      <span class="comment"># only score movies I haven't seen yet</span></span><br><span class="line">      <span class="keyword">if</span> item <span class="keyword">not</span> <span class="keyword">in</span> critics[person] <span class="keyword">or</span> critics[person][item]==<span class="number">0</span>:</span><br><span class="line">        <span class="comment"># Similarity * Score</span></span><br><span class="line">        totals.setdefault(item,<span class="number">0</span>)</span><br><span class="line">        totals[item]+=critics[other][item]*sim <span class="comment">#权重*评分</span></span><br><span class="line">        <span class="comment"># Sum of similarities</span></span><br><span class="line">        simSums.setdefault(item,<span class="number">0</span>)</span><br><span class="line">        simSums[item]+=sim        <span class="comment">#评委人数统计（相似度之和）</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Create the normalized list</span></span><br><span class="line">  rankings=[(total/simSums[item],item) <span class="keyword">for</span> item,total <span class="keyword">in</span> totals.items()]</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Return the sorted list</span></span><br><span class="line">  rankings.sort()</span><br><span class="line">  rankings.reverse()</span><br><span class="line">  <span class="keyword">return</span> rankings</span><br></pre></td></tr></table></figure><p></p><p>测试这段代码：<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">getRecommendations(critics,<span class="string">'小刘'</span>)</span><br><span class="line"><span class="comment">#返回[(3.35,'喜剧之王'),(2.83,'王牌特工'),(2.53,'疯狂原始人')]</span></span><br><span class="line"><span class="comment">#改用欧几里德距离再试下</span></span><br><span class="line">getRecommendations(critics,<span class="string">'小刘'</span>,similarity=sim_distance)</span><br><span class="line"><span class="comment">#返回[(3.50,'喜剧之王'),(2.75,'王牌特工'),(2.46,'疯狂原始人')]</span></span><br></pre></td></tr></table></figure><p></p><p>这里给出的得分，就是这个系统推测出的我对这些电影可能的评分。</p><p>至此，我们已经完成了一个完整推荐系统的搭建！<br>总结一下处理流程：</p><ol><li><p>我们首先要借助人们对物品的评分，建立一个坐标系，将人与人之间的相似度，转换为可以度量的空间坐标。<br>如下图所示：</p><img src="/2017/11/05/Marking-Recommendations/Euclidean_Distance.PNG" title="Educlidean_Distance"></li><li><p>得到相似度之后，将他们所给的评分乘上各自的相似度，最后除上相似度之和。<br>本文中的背景是，你没看过一部电影，但你可以参照看过这部电影的人们的评分，在考虑到这些人与你的相似度的情况下，依靠相似度权重和评分来预估自己打出的分数。</p></li></ol><hr><h1 id="如何实现根据自己已购买过的物品来推荐呐？"><a href="#如何实现根据自己已购买过的物品来推荐呐？" class="headerlink" title="如何实现根据自己已购买过的物品来推荐呐？"></a>如何实现根据自己已购买过的物品来推荐呐？</h1><p>自己没有尝试过的物品，可以依靠与我们相似的人的评价来判断自己对这个物品的喜好程度。</p><p>同样的：</p><p>自己没有尝试过的物品，也可以根据自己对买过的、尝试过的物品的评分，计算新物品与自己尝试过的物品的相似度，依靠相似度和评分来预估自己的对这个没尝试过的物品的喜好程度。</p><blockquote><p>这也就是很多网上购物平台，根据你已购买的商品，向你推荐新商品的原理。</p></blockquote><h2 id="如何得到物品和物品之间的相似度？"><a href="#如何得到物品和物品之间的相似度？" class="headerlink" title="如何得到物品和物品之间的相似度？"></a>如何得到物品和物品之间的相似度？</h2><p>怎么度量物品和物品之间的相似度呐？</p><p>回顾我们怎么计算人与人之间的相似度的，依靠我们对物品的评分，x轴为电影1，y轴为电影2建立坐标系，将人描绘成坐标上的一个点，方便度量。</p><p>此时，x轴和y轴变成了人，将物品为描绘成坐标轴上的点，这样就可以度量物品之间的距离或者皮尔逊相似度啦！<br>举例：</p><table><thead><tr><th>评论者</th><th>给《王牌特工》的评分</th><th>给《煎饼侠》的评分</th></tr></thead><tbody><tr><td>小王</td><td>2.5</td><td>3.5</td></tr><tr><td>小张</td><td>3.0</td><td>3.5</td></tr></tbody></table><p>转换后：</p><table><thead><tr><th>电影</th><th>小王的评分</th><th>小张的评分</th></tr></thead><tbody><tr><td>《王牌特工》</td><td>2.5</td><td>3.0</td></tr><tr><td>《煎饼侠》</td><td>3.5</td><td>3.5</td></tr></tbody></table><img src="/2017/11/05/Marking-Recommendations/transfer.png" title="转换"><p>写一段脚本完成上述数据结构的转换<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">transformPrefs</span><span class="params">(prefs)</span>:</span></span><br><span class="line">  result=&#123;&#125;</span><br><span class="line">  <span class="keyword">for</span> person <span class="keyword">in</span> prefs:</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> prefs[person]:</span><br><span class="line">      result.setdefault(item,&#123;&#125;)</span><br><span class="line">      </span><br><span class="line">      <span class="comment"># Flip item and person</span></span><br><span class="line">      result[item][person]=prefs[person][item]</span><br><span class="line">  <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure><p></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">movies = transformPrefs(critics)</span><br><span class="line">TopMatches(movies,<span class="string">'超能陆战队'</span>)</span><br><span class="line"><span class="comment">#[(0.65,'天空之城'),(0.48,'王牌特工') (0.11,'煎饼侠'),(-0.17,'喜剧之王'),(-0.42,'疯狂原始人')  ]</span></span><br></pre></td></tr></table></figure><p>注意这里存在相似度为负的电影，说明《超能陆战队》和《疯狂原始人》这两部电影的风格相反。</p><img src="/2017/11/05/Marking-Recommendations/minus_relation.png" title="物品负相关性"><p>可以从图中看出，给《超能陆战队》打高分的人，会给《疯狂原始人》打低分。</p><p>下面我们测试下之前写好的推荐函数：<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">getRecommendations(movies,<span class="string">'疯狂原始人'</span>)</span><br><span class="line"><span class="comment">#[(4.0,'小李'),(3.0,'小红')]</span></span><br><span class="line"><span class="comment"># 参照小李看过的电影，与《疯狂原始人》的相似度，加权重后取平均，估计出小李会给这部电影的分数为4.0分。</span></span><br><span class="line"><span class="comment"># 参照小红看过的电影，与《疯狂原始人》的相似度，加权重后取平均，估计出小红会给这部电影的分数为3.0分。</span></span><br></pre></td></tr></table></figure><p></p><p>总结一下预估的评分怎么算的：</p><ol><li><p>算用户相似度的方法：<br>你没见过的一部电影，参照看过这部电影的人，参照相似度进行加权重取平均，即为系统给你估计的你会给这部电影的评分。<br>结果是一个除法式，其分子和分母如下定义：<br>分子：<br>(人物1与你相似度 × 人物1给出的评分 + 人物2与你相似度 × 人物2给出的评分 +…人物n与你相似度 × 人物n给出的评分)</p><p>分母：<br>(人物1与你相似度+人物2与你的相似度+…人物n与你的相似度)</p></li><li><p>算物品相似度的方法：<br>你没见过的一部电影，参照你看过的电影，根据你看过的电影与当前这部电影的相似度加权重取平均，即为系统给你估计的你会给这个物品的评分。<br>结果是一个除法式，其分子和分母如下定义：<br>分子：<br>(你看过的电影1与这部电影的相似度 × 你看过的电影1给出的评分 + 你看过的电影2与这部电影的相似度 × 你看过的电影2给出的评分+…你看过的电影n与这部电影的相似度 × 你看过的电影n给出的评分)</p><p>分母：<br>(你看过的电影1与这部电影的相似度+你看过的电影2与这部电影的相似度+…你看过的电影n与这部电影的相似度)</p></li></ol><h2 id="基于一个人电影观看历史来预估他对新电影的评分"><a href="#基于一个人电影观看历史来预估他对新电影的评分" class="headerlink" title="基于一个人电影观看历史来预估他对新电影的评分"></a>基于一个人电影观看历史来预估他对新电影的评分</h2><p>我们已经学会了计算物品之间相似度的方法，以及‘基于用户相似度来进行推荐’扩展到‘基于物品相似度来进行推荐’的思路（上一小节，‘总结一下预估的评分怎么算的’），下面开始举例和编程实现‘基于物品相似度来获得推荐’的想法。<br>举例：<br>还是‘小刘’，他没看过的三部电影是《喜剧之王》、《王牌特工》、《疯狂原始人》。</p><table><thead><tr><th>已经看过的电影\没看过的电影</th><th>电影之间的相似度</th><th>喜剧之王</th><th>乘上相似度后累加</th></tr></thead><tbody><tr><td>煎饼侠</td><td>0.182</td><td>4.5</td><td>4.5*0.182=0.818</td></tr><tr><td>超能陆战队</td><td>0.103</td><td>4.0</td><td>4.0*0.103=0.412</td></tr><tr><td>天空之城</td><td>0.148</td><td>1.0</td><td>1.0*0.148=0.148</td></tr><tr><td><strong>总和</strong></td><td>0.433</td><td></td><td>1.378</td></tr></tbody></table><p>根据他的观看历史，预估的他可能给《喜剧之王》的评分为1.378/0.433=3.183</p><table><thead><tr><th>已经看过的电影\没看过的电影</th><th>电影之间的相似度</th><th>王牌特工</th><th>乘上相似度后累加</th></tr></thead><tbody><tr><td>煎饼侠</td><td>0.222</td><td>4.5</td><td>4.5*0.222=0.999</td></tr><tr><td>超能陆战队</td><td>0.091</td><td>4.0</td><td>4.0*0.091=0.363</td></tr><tr><td>天空之城</td><td>0.4</td><td>1.0</td><td>1.0*0.4=0.4</td></tr><tr><td><strong>总和</strong></td><td>0.713</td><td></td><td>1.762</td></tr></tbody></table><p>根据他的观看历史，预估的他可能给《王牌特工》的评分为1.762/0.713=2.473</p><table><thead><tr><th>已经看过的电影\没看过的电影</th><th>电影之间的相似度</th><th>疯狂原始人</th><th>乘上相似度后累加</th></tr></thead><tbody><tr><td>煎饼侠</td><td>0.105</td><td>4.5</td><td>4.5*0.105=0.474</td></tr><tr><td>超能陆战队</td><td>0.065</td><td>4.0</td><td>4.0*0.065=0.258</td></tr><tr><td>天空之城</td><td>0.128</td><td>1.0</td><td>1.0*0.128=0.182</td></tr><tr><td><strong>总和</strong></td><td>0.352</td><td></td><td>0.914</td></tr></tbody></table><p>根据他的观看历史，预估的他可能给《疯狂原始人》的评分为0.914/0.352=2.598</p><p>写出相关代码<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 与前面GetRecommendations函数不同，这里我们提前算好物品的相似度</span></span><br><span class="line"><span class="comment"># 而不是在GetRecommendation函数中计算相似度(调用similarity)，这样每次推荐都要重新计算相似度</span></span><br><span class="line"><span class="comment"># 前面的函数写法为</span></span><br><span class="line"><span class="comment"># def getRecommendations():</span></span><br><span class="line"><span class="comment">#     sim = similarity()#  这里就是计算相似度</span></span><br><span class="line"><span class="comment"># 提前算好物品之间相似度的方法，该方法也可以用于提前算好用户相似度</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculateSimilarItems</span><span class="params">(prefs,n=<span class="number">10</span>)</span>:</span></span><br><span class="line">  <span class="comment"># Create a dictionary of items showing which other items they</span></span><br><span class="line">  <span class="comment"># are most similar to.</span></span><br><span class="line">  result=&#123;&#125;</span><br><span class="line">  <span class="comment"># Invert the preference matrix to be item-centric</span></span><br><span class="line">  itemPrefs=transformPrefs(prefs)</span><br><span class="line">  c=<span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> item <span class="keyword">in</span> itemPrefs:</span><br><span class="line">    <span class="comment"># Status updates for large datasets</span></span><br><span class="line">    c+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> c%<span class="number">100</span>==<span class="number">0</span>: <span class="keyword">print</span> <span class="string">"%d / %d"</span> % (c,len(itemPrefs))</span><br><span class="line">    <span class="comment"># Find the most similar items to this one</span></span><br><span class="line">    scores=topMatches(itemPrefs,item,n=n,similarity=sim_distance)</span><br><span class="line">    result[item]=scores</span><br><span class="line">  <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取推荐的函数，prefs参数为评论者与观看过的电影的字典</span></span><br><span class="line"><span class="comment"># itemMatch为调用calculateSimilarItems提前算好的物品之间的相似度表格</span></span><br><span class="line"><span class="comment"># user 为当前用户</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getRecommendedItems</span><span class="params">(prefs,itemMatch,user)</span>:</span></span><br><span class="line">  userRatings=prefs[user]</span><br><span class="line">  scores=&#123;&#125;</span><br><span class="line">  totalSim=&#123;&#125;</span><br><span class="line">  <span class="comment"># Loop over items rated by this user</span></span><br><span class="line">  <span class="keyword">for</span> (item,rating) <span class="keyword">in</span> userRatings.items( ):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Loop over items similar to this one</span></span><br><span class="line">    <span class="keyword">for</span> (similarity,item2) <span class="keyword">in</span> itemMatch[item]:</span><br><span class="line"></span><br><span class="line">      <span class="comment"># Ignore if this user has already rated this item</span></span><br><span class="line">      <span class="keyword">if</span> item2 <span class="keyword">in</span> userRatings: <span class="keyword">continue</span></span><br><span class="line">      <span class="comment"># Weighted sum of rating times similarity</span></span><br><span class="line">      scores.setdefault(item2,<span class="number">0</span>)</span><br><span class="line">      scores[item2]+=similarity*rating</span><br><span class="line">      <span class="comment"># Sum of all the similarities</span></span><br><span class="line">      totalSim.setdefault(item2,<span class="number">0</span>)</span><br><span class="line">      totalSim[item2]+=similarity</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Divide each total score by total weighting to get an average</span></span><br><span class="line">  rankings=[(score/totalSim[item],item) <span class="keyword">for</span> item,score <span class="keyword">in</span> scores.items( )]</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Return the rankings from highest to lowest</span></span><br><span class="line">  rankings.sort( )</span><br><span class="line">  rankings.reverse( )</span><br><span class="line">  <span class="keyword">return</span> rankings</span><br><span class="line"><span class="comment"># 测试这两个函数</span></span><br><span class="line">itemsim = calculateSimilarItems(critics)</span><br><span class="line"><span class="comment">#&#123;'王牌特工':[(0.4,'天空之城'),(0.28,'喜剧之王')]...</span></span><br><span class="line"><span class="comment"># '煎饼侠':[(0.22,'王牌特工'),(0.18,'喜剧之王')]&#125;</span></span><br><span class="line">getRecommendedItems(critics,itemsim,<span class="string">'小刘'</span>)</span><br><span class="line"><span class="comment">#[(3.182,'喜剧之王'),(2.598,'疯狂原始人'),(2.473,'王牌特工')]</span></span><br></pre></td></tr></table></figure><p></p><hr><h1 id="使用基于用户相似性的方法还是基于物品相似性的？"><a href="#使用基于用户相似性的方法还是基于物品相似性的？" class="headerlink" title="使用基于用户相似性的方法还是基于物品相似性的？"></a>使用基于用户相似性的方法还是基于物品相似性的？</h1><p>如果每个人曾经购买的商品几乎涵盖了商城里所有的商品，这时的数据集叫“密集型”，对于密集型，基于用户和基于物品的相似性的方法性能差不多。<br>但大部分的情况是，一个人只买了商城中的一小部分物品，这时的数据集叫“稀疏型”，对于稀疏型，由于其购买的历史物品比较少，采用基于物品的相似性的方法会更快一些。如果是大型商城，一般是采用基于物品相似度的方法，因为其用户量高达上百万，每个用户都和剩下的所有人比对一遍计算量很大；而商城中物品的种类却相对稳定一些。<br>计算用户之间的相似度可以让我们了解到哪些用户偏好相似，构成用户组。基于物品之间的相似度可以将物品聚类，将相似度高的一组物品聚集成物品集。<br>不同的方法，可以获取到不同的信息，有时你会想了解那些用户相似，又时又会想了解哪些物品相似，两种算法都是有意义的。</p><h1 id="课后练习题解答提示"><a href="#课后练习题解答提示" class="headerlink" title="课后练习题解答提示"></a>课后练习题解答提示</h1><ol><li>Tanimoto分值 求出Tanimoto相似度评价值。在何种情况下，我们可以将该方法作为相似度的度量方法，用以代替欧几里德距离或皮尔逊系数法？请利用Tonamoto 分值建立一个新的相似度函数。<br>下一章节《发现群组》会讲具体应用，这里不再描述。</li><li>标签相似度 请使用del.icio.us API 构造一个涉及标签和链接的数据集。利用它来计算不同标签的相似度，看一看是否能找到相似度几乎一样的情况。请找出某些本应该被标记为“Program”，但却未被标记的链接。<br>解法就是计算物品和物品之间的相似度。</li><li>基于用户算法的执行效率 由于基于用户的过滤算法，在每次需要推荐时，都会将某些用户与其他所有用户进行比较，故效率低下。请编写一个预先计算好用户相似度的函数。并修改涉及推荐的相关代码，只取出当前用户外的其他前5名用户来给出推荐。<br>前面根据物品相似度获得推荐，就是提前计算好物品之间相似的，只不过这里换成了提前计算好用户的相似度。</li><li>基于物品的书签过滤 请从del.icio.us 网站下载一组数据，并将其加入数据集中。建立一张“物-物”表，并利用它为不同用户提供基于物品的推荐。将之与基于用户的推荐做一个对比。<br>这里就是基于用户相似度方和基于物品的相似度的方法都实践一下。</li><li>Audioscrobbler 请访问 <a href="http://www.audioscrobbler.net" target="_blank" rel="noopener">http://www.audioscrobbler.net</a> ,该网站拥有一个由大群用户的音乐偏好所构成的数据集。利用网站提供的Web Services API 获取一组数据，并以此来构建一个音乐推荐系统。<br>这里也是基于用户相似度方和基于物品的相似度的方法都实践一下。</li></ol></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>如果您觉得读完本文有收获，不妨小额赞助我一下，让我有动力继续写出高质量的教程！</div><button id="rewardButton" disable="enable"><span>打赏</span></button><div id="QR" style="display:block"><div id="wechat" style="display:inline-block"><img id="wechat_qr" src="/images/smacker.jpg" alt="倔强的土豆 微信支付"><p>微信支付</p></div></div></div></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2017/11/04/introduction-to-collective-intelligence/" rel="next" title="集体智慧导言"><i class="fa fa-chevron-left"></i> 集体智慧导言</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2017/11/12/cluster/" rel="prev" title="发现群组">发现群组 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="gitment-container"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">倔强的土豆</p><p class="site-description motion-element" itemprop="description">分享机器学习、深度学习的点滴</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">7</span> <span class="site-state-item-name">日志</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/laiqun" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:laiqun@msn.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#什么是推荐系统？"><span class="nav-number">1.</span> <span class="nav-text">什么是推荐系统？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#收集数据"><span class="nav-number">2.</span> <span class="nav-text">收集数据</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#计算相似度的方法"><span class="nav-number">3.</span> <span class="nav-text">计算相似度的方法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#欧几里德距离"><span class="nav-number">3.1.</span> <span class="nav-text">欧几里德距离</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#皮尔逊相关度"><span class="nav-number">3.2.</span> <span class="nav-text">皮尔逊相关度</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#从几何中的cos夹角公式理解皮尔逊相似度"><span class="nav-number">3.2.1.</span> <span class="nav-text">从几何中的cos夹角公式理解皮尔逊相似度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#从概率论的相关系数来理解皮尔逊相似度"><span class="nav-number">3.2.2.</span> <span class="nav-text">从概率论的相关系数来理解皮尔逊相似度</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#应该选用哪种相似性度量方法"><span class="nav-number">3.3.</span> <span class="nav-text">应该选用哪种相似性度量方法</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#寻找与自己相似品味的群体"><span class="nav-number">4.</span> <span class="nav-text">寻找与自己相似品味的群体</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#推荐物品"><span class="nav-number">5.</span> <span class="nav-text">推荐物品</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#如何实现根据自己已购买过的物品来推荐呐？"><span class="nav-number">6.</span> <span class="nav-text">如何实现根据自己已购买过的物品来推荐呐？</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#如何得到物品和物品之间的相似度？"><span class="nav-number">6.1.</span> <span class="nav-text">如何得到物品和物品之间的相似度？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基于一个人电影观看历史来预估他对新电影的评分"><span class="nav-number">6.2.</span> <span class="nav-text">基于一个人电影观看历史来预估他对新电影的评分</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#使用基于用户相似性的方法还是基于物品相似性的？"><span class="nav-number">7.</span> <span class="nav-text">使用基于用户相似性的方法还是基于物品相似性的？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#课后练习题解答提示"><span class="nav-number">8.</span> <span class="nav-text">课后练习题解答提示</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2018</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">倔强的土豆</span></div><div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div><span class="post-meta-divider">|</span><div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.3</div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script><link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css"><script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script><script type="text/javascript">function renderGitment(){var a=new Gitmint({id:window.location.pathname,owner:"laiqun",repo:"laiqun.github.io",lang:navigator.language||navigator.systemLanguage||navigator.userLanguage,oauth:{client_secret:"55aaeb736714431ea52109dd66461b1644ca6177",client_id:"c90dfa80285ea91b9120"}});a.render("gitment-container")}renderGitment()</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });</script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html><!-- rebuild by neat -->